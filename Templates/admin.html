{% extends 'layout.html' %}

{% block title %}Admin Panel{% endblock %}

{% block content %}
<div class="container mt-4">
    <section style="padding: 30px 0; text-align: center;">
        <h2 style="color: white;">Welcome, {{ session['user']['userinfo']['name'] if 'userinfo' in session['user'] else 'Admin' }}!</h2>
        <p style="color: #FFCA84;">You can view and manage maintenance requests below.</p>
    </section>

    <!-- Centered Looker Studio Iframe -->
    <section>
        <div class="container text-center">
            <iframe width="800" height="600" src="https://lookerstudio.google.com/embed/reporting/4f365e83-f063-424b-a00c-32a70dd87d83/page/vtUDE" frameborder="0" style="border:0; margin: 0 auto;" allowfullscreen sandbox="allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"></iframe>
        </div>
    </section>

    <section style="padding: 20px 0;">
        <h3 style="color: white; text-align: center;">Maintenance Requests</h3>

        <!-- Scrollable Table to display maintenance requests -->
        <div style="max-height: 400px; overflow-y: auto; border: 1px solid #FFCA84;">
            <table class="table table-striped table-dark" style="color: white; margin-bottom: 0;">
                <thead>
                    <tr>
                        <th scope="col">Issue ID</th>
                        <th scope="col">Student ID</th>
                        <th scope="col">Building Type</th>
                        <th scope="col">Department</th>
                        <th scope="col">Issue Type</th>
                        <th scope="col">Certainty</th>
                    </tr>
                </thead>
                <tbody>
                    {% for request in maintenance_requests %}
                    <tr>
                        <td>{{ request['issue_id'] }}</td>
                        <td>{{ request['student_id'] }}</td>
                        <td>{{ request['building_type'] }}</td>
                        <td>{{ request['department'] }}</td>
                        <td>{{ request['issue_type'] }}</td>
                        <td>{{ request['certainty'] }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </section>
</div>

<!-- Custom CSS for the Admin Panel -->
<style>
    body {
        background-color: #000;
    }

    h2, h3 {
        font-family: 'Helvetica', sans-serif;
        color: white;
    }

    p {
        color: #FFCA84;
        font-size: 1.2rem;
    }

    .table {
        background-color: #111;
        color: white;
        border: 1px solid #FFCA84;
    }

    .table thead th {
        color: #FFCA84;
        border-bottom: 2px solid #FFCA84;
    }

    .table tbody tr {
        border-bottom: 1px solid #444;
    }

    .table tbody tr:hover {
        background-color: #222;
    }

    /* Style for the iframe section */
    iframe {
        margin: 0 auto;
        display: block;
        border: 2px solid #FFCA84;
        border-radius: 8px;
    }

    /* Scrollable table container */
    .table-container {
        max-height: 400px; /* Adjust the height of the scrollable area */
        overflow-y: scroll;
        border: 1px solid #FFCA84;
    }
</style>
{% endblock %}